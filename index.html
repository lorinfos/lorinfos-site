<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LORINFOS</title>
  <meta name="description" content="Des √©nigmes courtes pour tester ta logique. La plupart se trompent." />

  <style>
    :root{
      --gold:#D7A11E;
      --gold2:#F2D37A;
      --ink:#0B0B0D;
      --panel:rgba(20,20,24,.72);
      --panel2:rgba(255,255,255,.06);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --line:rgba(255,255,255,.10);
      --shadow:0 18px 50px rgba(0,0,0,.55);
      --radius:26px;
      --radius2:18px;
      --max:860px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 700px at 20% 0%, rgba(215,161,30,.18), transparent 60%),
        radial-gradient(900px 520px at 85% 15%, rgba(242,211,122,.10), transparent 55%),
        radial-gradient(1200px 900px at 50% 110%, rgba(0,0,0,.65), rgba(0,0,0,.95)),
        #07070A;
      overflow-x:hidden;
    }

    .wrap{
      width:min(var(--max), calc(100% - 34px));
      margin:28px auto 46px;
    }

    .hero{
      position:relative;
      border-radius:32px;
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(700px 240px at 35% 15%, rgba(215,161,30,.25), transparent 65%),
        radial-gradient(680px 260px at 75% 25%, rgba(242,211,122,.14), transparent 62%),
        linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.65));
      filter:saturate(1.05);
      pointer-events:none;
    }
    .heroInner{
      position:relative;
      padding:22px 18px 18px;
      display:flex;
      gap:14px;
      align-items:flex-start;
    }
    .logo{
      width:62px; height:62px;
      border-radius:16px;
      flex:0 0 auto;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      display:grid; place-items:center;
      overflow:hidden;
      box-shadow: 0 10px 25px rgba(0,0,0,.45);
    }
    .logo img{width:100%; height:100%; object-fit:cover; display:block;}

    .brand h1{
      margin:0;
      letter-spacing:.08em;
      font-weight:900;
      font-size:34px;
      line-height:1.05;
      text-transform:uppercase;
      text-shadow: 0 10px 24px rgba(0,0,0,.55);
    }
    .brand p{
      margin:8px 0 0;
      color:var(--muted);
      font-size:16px;
      line-height:1.45;
    }

    .actions{
      position:relative;
      padding:0 18px 18px;
      display:grid;
      gap:12px;
    }

    .btn{
      width:100%;
      border:0;
      border-radius:999px;
      padding:16px 18px;
      font-weight:800;
      font-size:17px;
      letter-spacing:.01em;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      transition: transform .12s ease, filter .12s ease, box-shadow .12s ease;
      user-select:none;
    }
    .btn:active{transform:translateY(1px) scale(.995)}
    .btnGold{
      color:#1a1200;
      background:linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow: 0 14px 30px rgba(215,161,30,.22), 0 10px 22px rgba(0,0,0,.55);
    }
    .btnDark{
      color:var(--text);
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 12px 26px rgba(0,0,0,.55);
    }

    .section{
      margin-top:22px;
    }
    .section h2{
      margin:0 0 10px;
      font-size:42px;
      line-height:1.02;
      letter-spacing:.01em;
      text-shadow: 0 12px 26px rgba(0,0,0,.65);
    }
    .section h2 .emoji{filter:drop-shadow(0 8px 14px rgba(0,0,0,.6))}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border:1px solid rgba(215,161,30,.22);
      box-shadow: var(--shadow);
      border-radius:var(--radius);
      padding:16px;
      overflow:hidden;
    }

    .notice{
      display:flex;
      gap:12px;
      align-items:flex-start;
      color:rgba(255,255,255,.82);
      border:1px solid rgba(215,161,30,.25);
      background:linear-gradient(180deg, rgba(215,161,30,.12), rgba(0,0,0,.18));
    }
    .notice .icon{font-size:20px; line-height:1.2}
    .notice strong{color:rgba(255,255,255,.92)}
    .notice p{margin:0; line-height:1.45}

    .grid{
      margin-top:14px;
      display:grid;
      gap:14px;
    }

    .puzzle{
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.025));
      border-radius:22px;
      padding:16px;
    }
    .puzzleTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      font-weight:900;
      letter-spacing:.02em;
    }
    .question{
      margin:0;
      font-size:20px;
      line-height:1.35;
      color:rgba(255,255,255,.92);
    }
    .hint{
      margin:12px 0 0;
      color:rgba(255,255,255,.70);
      font-size:14px;
      line-height:1.45;
    }

    .answerBtn{
      margin-top:14px;
      padding:14px 16px;
      font-size:16px;
    }

    .resources{
      display:grid;
      gap:14px;
      margin-top:14px;
    }
    .resource{
      border-radius:22px;
      padding:16px;
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      display:grid;
      gap:10px;
    }
    .resource h3{margin:0; font-size:18px}
    .resource p{margin:0; color:rgba(255,255,255,.72); line-height:1.45}
    .resource a{
      display:inline-flex;
      justify-content:center;
      align-items:center;
      gap:10px;
      text-decoration:none;
      padding:14px 16px;
      border-radius:999px;
      font-weight:900;
      color:#1a1200;
      background:linear-gradient(180deg, var(--gold2), var(--gold));
      box-shadow: 0 12px 26px rgba(215,161,30,.18), 0 10px 22px rgba(0,0,0,.55);
    }

    .errorBox{
      margin-top:14px;
      border-radius:18px;
      padding:14px;
      border:1px solid rgba(255,80,80,.30);
      background:linear-gradient(180deg, rgba(255,80,80,.10), rgba(0,0,0,.20));
      color:rgba(255,255,255,.90);
      display:none;
    }
    .errorBox code{
      display:block;
      margin-top:8px;
      padding:10px 12px;
      border-radius:14px;
      background:rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.10);
      color:rgba(255,255,255,.85);
      overflow:auto;
      font-size:12px;
    }

    footer{
      margin-top:22px;
      text-align:center;
      color:rgba(255,255,255,.55);
      font-size:14px;
      padding:18px 0 8px;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modalCard{
      width:min(720px, 100%);
      border-radius:26px;
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 25px 60px rgba(0,0,0,.70);
      overflow:hidden;
    }
    .modalHead{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modalHead strong{font-size:15px; letter-spacing:.02em}
    .close{
      border:0;
      background:rgba(255,255,255,.10);
      color:rgba(255,255,255,.90);
      border-radius:12px;
      padding:10px 12px;
      font-weight:900;
      cursor:pointer;
    }
    .modalBody{
      padding:14px 16px 16px;
      color:rgba(255,255,255,.86);
      line-height:1.5;
      font-size:16px;
    }
  </style>
</head>

<body>
  <main class="wrap">
    <section class="hero" aria-label="En-t√™te LORINFOS">
      <div class="heroInner">
        <div class="logo" aria-label="Logo">
          <img src="logo.png" alt="Logo LORINFOS">
        </div>
        <div class="brand">
          <h1>LORINFOS</h1>
          <p>Des √©nigmes courtes pour tester ta logique.<br>La plupart se trompent.</p>
        </div>
      </div>

      <div class="actions">
        <button class="btn btnGold" type="button" id="goEnigmes">üß© √ânigmes & R√©ponses</button>
        <button class="btn btnDark" type="button" id="goRessources">üß† Muscler son cerveau</button>
      </div>
    </section>

    <section class="section" id="enigmes">
      <h2><span class="emoji">üß©</span> √ânigmes & R√©ponses</h2>

      <div class="card notice">
        <div class="icon">‚ö†Ô∏è</div>
        <p>
          <strong>Pour faire vivre le site</strong>, certaines r√©ponses peuvent ouvrir une courte publicit√©.
          Ferme simplement l‚Äôonglet de pub et reviens ici : <strong>la r√©ponse s‚Äôaffiche ensuite</strong>.
        </p>
      </div>

      <div class="errorBox" id="errEnigmes">
        <strong>Je n‚Äôarrive pas √† charger <code>enigmes.json</code>.</strong>
        <div style="height:8px"></div>
        V√©rifie que le fichier est bien √† la racine du repo et qu‚Äôil s‚Äôappelle exactement <code>enigmes.json</code> (minuscule).
        <code id="errEnigmesDetail"></code>
      </div>

      <div class="grid" id="enigmesList" aria-live="polite"></div>
    </section>

    <section class="section" id="ressources">
      <h2><span class="emoji">üß†</span> Muscler son cerveau</h2>

      <div class="errorBox" id="errRessources">
        <strong>Je n‚Äôarrive pas √† charger <code>ressources.json</code>.</strong>
        <div style="height:8px"></div>
        V√©rifie que le fichier est bien √† la racine du repo et qu‚Äôil s‚Äôappelle exactement <code>ressources.json</code>.
        <code id="errRessourcesDetail"></code>
      </div>

      <div class="resources" id="ressourcesList" aria-live="polite"></div>
    </section>

    <footer>¬© LORINFOS ‚Äî Tous droits r√©serv√©s.</footer>
  </main>

  <!-- Modal r√©ponse -->
  <div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="R√©ponse">
    <div class="modalCard">
      <div class="modalHead">
        <strong id="modalTitle">R√©ponse</strong>
        <button class="close" id="closeModal" type="button">‚úï</button>
      </div>
      <div class="modalBody" id="modalBody"></div>
    </div>
  </div>

  <script>
    // Base URL (important sur GitHub Pages + quand il y a un #hash)
    const base = new URL('.', window.location.href);

    const $ = (id) => document.getElementById(id);

    // Navigation douce
    $("goEnigmes").addEventListener("click", () => {
      document.getElementById("enigmes").scrollIntoView({behavior:"smooth", block:"start"});
      history.replaceState(null, "", "#enigmes");
    });
    $("goRessources").addEventListener("click", () => {
      document.getElementById("ressources").scrollIntoView({behavior:"smooth", block:"start"});
      history.replaceState(null, "", "#ressources");
    });

    // Modal
    const modal = $("modal");
    const openModal = (title, html) => {
      $("modalTitle").textContent = title;
      $("modalBody").innerHTML = html;
      modal.style.display = "flex";
    };
    const closeModal = () => modal.style.display = "none";
    $("closeModal").addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if(e.target === modal) closeModal(); });

    // Fetch helper (petit cache-buster pour √©viter Safari qui garde l‚Äôancien JSON)
    async function fetchJSON(filename){
      const url = new URL(filename, base);
      url.searchParams.set("v", Date.now().toString());
      const res = await fetch(url.toString(), { cache: "no-store" });
      if(!res.ok) throw new Error(res.status + " " + res.statusText + " ‚Äî " + url.toString());
      return await res.json();
    }

    function escapeHTML(str){
      return String(str).replace(/[&<>"']/g, s => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[s]));
    }

    // Rendu √©nigmes
    function renderEnigmes(data){
      const list = $("enigmesList");
      list.innerHTML = "";

      const affiliateUrl = data?.affiliate_url || "";
      const enigmes = Array.isArray(data?.enigmes) ? data.enigmes : [];

      if(enigmes.length === 0){
        list.innerHTML = `<div class="card">Aucune √©nigme pour l‚Äôinstant. Ajoute-en une dans <code>enigmes.json</code> ‚úÖ</div>`;
        return;
      }

      for(const e of enigmes){
        const badge = escapeHTML(e.badge ?? "üß©");
        const titre = escapeHTML(e.titre ?? "√ânigme");
        const question = escapeHTML(e.question ?? "");
        const reponse = escapeHTML(e.reponse ?? "");
        const astuce = escapeHTML(e.astuce ?? "");

        const card = document.createElement("article");
        card.className = "puzzle";

        card.innerHTML = `
          <div class="puzzleTop">
            <div class="badge">${badge} <span>${titre}</span></div>
          </div>

          <p class="question">${question}</p>

          <button class="btn btnGold answerBtn" type="button">
            üëâ Voir la r√©ponse
          </button>

          ${astuce ? `<p class="hint">Astuce : ${astuce}</p>` : ""}
        `;

        const btn = card.querySelector("button");
        btn.addEventListener("click", () => {
          // Si tu mets un lien d‚Äôaffiliation global, on ouvre d‚Äôabord la pub,
          // puis on affiche la r√©ponse dans une modal.
          if(affiliateUrl && affiliateUrl.trim() && !affiliateUrl.includes("TON_LIEN_")){
            window.open(affiliateUrl, "_blank");
          }
          openModal(titre, `<strong>R√©ponse :</strong><br>${reponse}`);
        });

        list.appendChild(card);
      }
    }

    // Rendu ressources
    function renderRessources(data){
      const list = $("ressourcesList");
      list.innerHTML = "";

      const ressources = Array.isArray(data?.ressources) ? data.ressources : [];

      if(ressources.length === 0){
        list.innerHTML = `<div class="card">Aucune ressource pour l‚Äôinstant. Ajoute-en dans <code>ressources.json</code> ‚úÖ</div>`;
        return;
      }

      for(const r of ressources){
        const titre = escapeHTML(r.titre ?? "Ressource");
        const desc = escapeHTML(r.description ?? "");
        const url = (r.url ?? "").toString().trim();

        const item = document.createElement("div");
        item.className = "resource";

        item.innerHTML = `
          <h3>${titre}</h3>
          ${desc ? `<p>${desc}</p>` : ""}
          ${url ? `<a href="${url}" target="_blank" rel="noopener">üõí Voir</a>` : `<p style="opacity:.7">Lien manquant</p>`}
        `;

        list.appendChild(item);
      }
    }

    // Boot
    (async function init(){
      // Enigmes
      try{
        const enigmes = await fetchJSON("enigmes.json");
        renderEnigmes(enigmes);
      }catch(err){
        $("errEnigmes").style.display = "block";
        $("errEnigmesDetail").textContent = String(err);
      }

      // Ressources
      try{
        const ressources = await fetchJSON("ressources.json");
        renderRessources(ressources);
      }catch(err){
        $("errRessources").style.display = "block";
        $("errRessourcesDetail").textContent = String(err);
      }
    })();
  </script>
</body>
</html>
